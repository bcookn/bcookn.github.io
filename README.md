## Welcome to my GitHub!
### <ins>Evaluating GHG Emissions by Neighborhood Wealth</ins>

#### Overview
*"The 1 percent could emit 30 times more than the poorest 50 percent and 175 times more than the poorest 10 percent"*
<br> 
> -- Oxfam Media Briefing, 2015

Do high income neighborhoods emit more GHG emissions than low income neighborhoods? If so, by how much? This is a short project that evaluates GHG emissions on a neighborhood-level in California as part of my capstone for my masters program. I am primarily interested in the differences in emissions between high income neighborhoods and low income neighborhoods. To do this, I will be utilizing subclassification and matching via k-nearest neighbors to control for the differences in means and estimate average treatment effects. 

#### Data
Multiple data sources were used and combined into one large dataframe for this analysis. The four datasets sourced are from the following: UC Berkeley’s Cool Climate Program, Google Earth Engine, U.S. Census, and the California Government. Berkeley’s Cool Climate Program dataset makes up most of the data, containing observations related to GHG emissions, CO2 emissions, etc. on a zip code level. Satellite data was pulled using Google Earth Engine which contains temperatures by zip code, and both the U.S. Census and California Government data were used to get income and urban/rural classification data, respectively. One of the biggest challenges was cleaning and combining the datasets in a usable format, without sacrificing a good chunk of observations. The end result had a final observation size of 1594, with 956 observations that are categorized as “low income” and 638 observations that are categorized as “high income”. Additionally, here are the summary statistics:

<img width="788" alt="image" src="https://user-images.githubusercontent.com/65251932/168404593-27d97ddf-7432-4660-8679-5846dd36b920.png">

#### Methods
The primary methods used in this analysis were subclassification and matching. To control for differences in income, there needed to be some type of grouping to compare GHG emissions across different neighborhoods with the same income distribution. To do this, neighborhoods were placed into buckets relative to the average household income and average number of people per household. Once the dataset was adjusted for income distribution, it was clear that there was some fairly significant difference in GHG emissions between the two groups. The next step was to try and compare low income neighborhoods to high income neighborhoods; however, the problem is that not all high/low income neighborhoods are similar. For example, you cannot compare East Oakland to Compton, or Atherton to Beverly Hills. This is due to differences in climate/temperature, population density, car usage-- all things that could possibly impact overall GHG emissions. To solve for this, a method called matching was used. What this does is that it matches each high income neighborhood with a similar low income neighborhood. Essentially, it's similar to finding high/low income neighborhood twins. With matching, comparisons between low and high income neighborhoods become comparable. To determine a matching estimator, we leaned on k-nearest neighbors to do the heavy lifting. All that was needed was to define measurements of proximity to establish baselines on how similar observations were to each other. To correct for confounding variables, the features were standardized and scaled. The final piece is that we used a combination of OLS and the CausalModel function from the `causalinference` package. These two methods gave us the true average treatment effect of low income neighborhoods on GHG emissions.

#### Results
And now it's time for the real bread and butter of this project-- the results! During the beginning stages of this project, a simple scatter plot was made to determine if a relationship even existed between GHG emissions and income.
<br>

![image](https://user-images.githubusercontent.com/65251932/163735451-323453f4-4e76-41c4-812f-c24fb0fc067d.png)

Lo and behold! A positive relationship does in fact seem to exist. However as seen in the visualization, there is a lot of bunching and blending in the middle which gives us a somewhat mixed message. This tends to happen with income data, as folks who are in the middle tend to have incentives to lie about income due to government incentives or programs. To get a better look at this relationship, an SLR (simple linear regression) model was ran with GHG emissions as the dependent variable and income as the independent variable.
<br>

![image](https://user-images.githubusercontent.com/65251932/163735448-83b9b5d5-96c5-4526-825c-fdb843777708.png)

These initial results were fairly promising, as income seemed to explain 57% of the variability in the data. It's saying that for every $1 increase in average neighborhood household income, CO2e increases by 0.0003 metric tons. To put this into perspective, 0.0003 tCO2e is equivalent to GHG emissions from 0.75 miles driven in an ICE (internal combustion engine) vehicle. 

Another OLS regression was ran, this time with interaction variables to evaluate the effect of income on GHG emissions while keeping population density in mind. GHG emissions is the dependent variable, with income and population density as the independent variables and as the interaction variable. 

![image](https://user-images.githubusercontent.com/65251932/163735432-bcbf8688-d9f0-4534-8d7c-150a95eb40c7.png)

While the p-value is fairly insignificant (as well as the confidence interval, i.e. it crosses 0) the negative coefficient in the interaction term suggests that income is less strongly related to emission in areas where population density is larger. There could be many factors contributing to this, such as miles traveled in cars. From a qualitative perspective, this would make sense. People who live in Fresno or Tracy (more rural areas) might have to drive more than people who live in San Francisco, where there is a halfway-decent public transportation system that is established. Though our data is focused on California, let's also take a look at New York. New York City's population size is very different from Buffalo. The population in Buffalo is about 250,000, while New York City's population is roughly twice the amount. New York City has a well-developed public transportation system in the five boroughs, and thus most New Yorkers do not have a car (and if they do, it's rarely used). Living in Buffalo on the other hand, would require a car. So it is likely that the more metropolitan an area is, the more likely a public transportation system exists-- which in turn, lessens overall GHG emissions.

The next step is to estimate the ATE (average treatment effect) for high income neighborhoods versus low income neighborhoods. To get a baseline measurement, we do a simple calculation of differences in outcomes between high and low income neighborhoods (not taking into account heterogeneous treatment effect bias, scaling, or feature standardization). In the difference in outcomes, we see that low income neighborhoods emit 8.09 metric tons of CO2e less than high income neighborhoods a year. To account for biases, scaling, and feature standardization, the next step was to run a k-nearest neighbors model to give us a more accurate ATE. The features that were used and scaled are population density, houses per zip code, vehicle miles traveled, temperature in Fahrenheit, and whether a neighborhood was rural or urban. With the bias correction formula, the final result yielded an average treatment effect of about -2.60. This suggests that on an annual basis, low income neighborhoods emitt 2.60 metric tons of CO2e *less* than high income neighborhoods. To put this value into perspective, 2.60 tCO2e is equivalent to GHG emissions from 6454 miles driven in an ICE (internal combustion engine) vehicle or 2877 pounds of coal burned (think about driving from New York to California and back).

As a sanity check (and to get the confidence intervals), the CausalModel function from the `causalinference` package was used. The average treatment effect is relatively the same as the one that was manually calculated.

<img width="836" alt="image" src="https://user-images.githubusercontent.com/65251932/168404702-7b612480-d863-489a-831a-63d73cfa5cbb.png">

Thus, we can confirm that low income neighborhoods do emit less GHG than their high income counterparts. There could be many reasons for this— perhaps high income neighborhoods are less metropolitan and farther out, resulting in higher CO2e emissions from their ICE vehicles. Or perhaps low income neighborhoods don't have as many goods that require energy consumption. There is also the possibility that the ATE between low and high income neighborhoods is understated, due to high income communities having more energy efficient infrastructure. This can be shown in the following visualization of the GHG emissions on average by low income versus high income neighborhoods.

![image](https://user-images.githubusercontent.com/65251932/168404453-98fca03c-da8f-4ae0-bf09-4029e73181b9.png)

![image](https://user-images.githubusercontent.com/65251932/168404467-cda3729f-c71c-498d-a8b1-fee786956345.png)

Before closing off, there are a few missing pieces to this project. One of the limitations was the timeline, as the full cycle of this project had to be completed in two months. There are also many factors that contribute to GHG emissions that were not included in the model, so it is important to note that our final results may either be inflated or understated due to omitted variable bias. Finally, there is also the issue in that the more features we have, the higher the distance between units and their matches. This is known as the curse of dimensionality, which causes additional bias problems as well. It is (unfortunately) a phenomena that exists in all areas of data science/econometrics, though we can somewhat rely on linear regression to perform dimensionality reduction to estimate the ATE!
